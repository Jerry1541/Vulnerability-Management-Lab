# Vulnerability-Management-Lab

## Objective

Personal project to get familiar with the concepts of vulnerability management and use popular tools such as Nessus and Burpsuite to gain hands on skills and experience identifying, responding, and remediating to vulnerabilities existing within a compromised system.

### Skills Learned

- 	Understanding the process of vulnerability management
-	Use of industry tools like Nessus to perform scans with and without credentials
-	Use tools like Burpsuite to identify potential vulnerabilities in hosts, intercept and alter HTTP traffic
-	Remediate vulnerabilities and learn mitigative strategies

### Tools Used

-	Nessus Essentials
-	Oracle Virtual Box, Windows 10 ISO
-	PortSwigger Burpsuite Community Edition | Burp Proxy | Burp browser

----

# Part I - Defensive Security with Nessus

## Steps

<p align="center">
    <img src="https://i.imgur.com/NA8v4wE.png" height="50%" width="50%" alt=""/> <br/>
    Project Overview <br/>
</p>

-	Set up and install Virtualization platform (Oracle Virtual Box/VMWare Workstation) and Windows 10 ISO
    -	Bridged NIC
-	Install and login to Nessus essentials (Need activation code)
    -	Save the url for Nessus
    -	Create credentials and save them
-	Run a basic scan against VM to ensure connectivity
    -	Discover VM IP
    -	Ping from local machine
    -	Disable firewall in VM
    -	Create and run scan from Nessus
-	Run credentialed scans
    -	Enable credentialed scan on VM
        -	Enable Remote Registry for scanner to scan registers on machine
        -	Enable file and printer sharing
        -	In User Account Controls disable notifications
        -	In Registry add key for remote account to connect (further disable User Account Controls)
        -	Add DWORD LocalAccountTokenFilterPolicy (<a href="https://community.tenable.com/s/article/Scanning-with-non-default-Windows-Administrator-Account?language=en_US">Documenatation</a>)
        -	Set value to 1
    -	Create and provide credentials for scan (Nessus)
        -	Run previous scan with credentials of VM added
        -	Inspect scan with vulnerabilities and remedies
-	Install deprecated software (Firefox old version)
-	Run credentialed scan with deprecated Firefox
-	Remediate vulnerabilities
-	Rescan

### Notes

-	Scans the systems:
    -	Services
    -	Registry
    -	Open ports
    -	File system
-	Remediation can involve:
    -	Software updates (third-party patches, Windows OS update)
    -	Misconfigurations
    -	Removal of malware
- Asset discovery
-	Vulnerability assessment
-	Compliance


## Workbooks

<p align="center">
    <img src="https://i.imgur.com/5kKB1AR.png" height="50%" width="50%" alt=""/> <br/>
    Vulnerable VM with outdated software, reduced UAC controls, and disabled firewall rules <br/>
</p>
<p align="center">
    <img src="https://i.imgur.com/bf0zKl4.png" height="50%" width="50%" alt=""/> <br/>
    Initial credentialed scan of VM with Nessus <br/> <br/>
</p>
 
## References
Josh Madakor. (2021b, October 28). Nessus tutorial for beginners: Vulnerability Management (PUT THIS ON YOUR RESUME!) [Video]. YouTube. https://www.youtube.com/watch?v=lT6Px9zJM3s

----

# Part II - Offensive Security with Burpsuite

## Steps
-	Install Burpsuite on host machine
-	Set up Burp proxy
    -	Go to Proxy
    -	Change to intercept on
    -	Open burp browser and go to portswigger.net
    -	Doing so will show the request (HTTP traffic) intercepted by Burp proxy
    -	Turn intercept off and it will load normally
    -	HTTP history will show HTTP traffic even when not intercepted by Burpsuite
-	Intercept HTTP traffic
    -	Turn on intercept and capture request packet to server
    -	Shows GET method used with other parameters and information
    -	One can also view the HTTP history viewed by Burp browser and recorded by the proxy

<p align="center">
    <img src="https://i.imgur.com/TDmaF9a.png" height="50%" width="50%" alt=""/> <br/>
    HTTP traffic intercepted by Burp Proxy through Burp browser <br/>
</p>

-	Modify the HTTP requests
    -	Login into PortSwigger lab to access dummy e-commerce website
    -	Select a product
    -	Turn on intercept and capture add to cart function
    -	Change the price to a desirable amount (affordable!)
    -	Forward the request via Burp proxy
    -	Go to cart and purchase the cheap product (changed prices)
    -	Example of excessive trust in client-side controls
        -	Do not expect client side to perform the HTTP requests without making modifications before sending to server (such as change price)
        -	Solution: Have proper server-side validation and perform integrity checks in data input from client

<p align="center">
    <img src="https://i.imgur.com/n0m0IYj.png" height="50%" width="50%" alt=""/> <br/>
    Successful  modification of HTTP request of product leather jacket <br/>
</p>
<p align="center">
    <img src="https://i.imgur.com/PzrHEzq.png" height="50%" width="50%" alt=""/> <br/>
    Intercepted add-to-cart function for investigation and alteration of request before sending to server <br/>
</p>

-	Set target scope
    -	To focus on specific target (URL/host) and reduce noise, a target scope is set
    -	Under Proxy < HTTP history, traffic is recorded from all sources
    -	To filter to a specific target, select Target < Site map, then one of the sources of left hand side, right click and add to scope, select yes to pop-up
    -	Go back to Proxy < HTTP history, and change filter to checkbox to Show only in-scope items

<p align="center">
    <img src="https://i.imgur.com/Dbb0wBJ.png" height="50%" width="50%" alt=""/> <br/>
    List of HTTP history with changed target scope <br/>
</p>

-	Use Burp Repeater to reissue requests
    -	Resends requests from client to server repeatedly to determine behavior of response to different inputs
    -	First, select a interesting request like product details from HTTP history, and right click to ‘Send to Repeater’
    -	Under Repeater tab, request is shown; change the productID variable to different integer values to see the response. Now change it to unexpected input like text
    -	The website returns a stack trace containing sensitive information such as the application used with its version
    -	The version used could contain security vulnerabilities, thus enabling a hacker to exploit the not updated software

<p align="center">
    <img src="https://i.imgur.com/b3kBSrL.png" height="50%" width="50%" alt=""/> <br/>
    Burp Repeater used for discovering information disclosure <br/> <br/>
</p>

## References
<a href="https://portswigger.net/burp/documentation/desktop/getting-started">PortSwigger Burpsuite Tutorial</a>
